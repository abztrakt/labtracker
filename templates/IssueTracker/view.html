{% extends "IssueTracker/base_generic.html" %}
{% block pageCSS %}
#issue { max-width: 700px; }
#title { }
#description {
    padding: 1em;
    min-width: 600px;
    min-height: 300px;
    border: 1px #CCCCCC solid;
}
ul.floated { margin: 0em 1em; padding: 0px; }
ul.floated li {
    float: left;
    margin: 0px 1em 2px;
    padding: 0px;
}
#info {
    padding: .5em 0em;
    background: #FFFF99;
    border: 1px #CCCCCC solid;
}
h4 {
    margin: 0px;
    padding: 0px;
    display: inline;
}
#problems {
    padding: .5em;
    background: #FFCCAA;
    border: 1px #CCCCCC solid;
    margin: 1em;
}
#problems h3 {
    margin: 0px;
    display: inline;
}
#problems ul { display: inline; }
#problems ul li { margin: 0px 1em 2px; }

div.comment {
    max-width: 700px;
    border: 1px dotted #DDD;
    margin-bottom: 5px;
}
div.post_date { background: #DDD; }
form#post_comment { width: 700px; }

div#main_issue {
    float: left;
    width: 700px;
}

div#issue_side {
    float: left;
    width: 220px;
    padding: 1em;
    margin: 8em 0em 0em 1em;
    border: 1px #66FF00 solid;
    min-height: 300px;
    background-color: #DDFFDD;
}

div.history ul { padding: 0px; margin: 0px; }
div.history ul li { padding: 0px; margin: 0em 0em 0em 1em; }

{% endblock %}

{% block content %}
<div id="main_issue">
<div id="issue">
    <h2 id="title">{{ issue.title }}</h2>
    <div id="info">
        <ul class="floated struct">
            <li><h4>Reporter:</h4>  {{ issue.reporter }}</li>
            <li><h4>Time Posted:</h4>  {{ issue.post_time }}</li>
            <li class="clear"><h4>Inventory Type</h4>  {{ issue.it }}</li>
            <li><h4>Group:</h4>  {{ issue.group }}</li>
            <li><h4>Item:</h4>  {{ issue.item }}</li>
            <li><h4>Assigned to:</h4>  {{ issue.assignee }}</li>
            <li><h4>State:</h4>  {{ issue.resolved_state }}</li>
        </ul>
        <br class="clear" />
    </div>
    <p id="description">{{ issue.description }}</p>
    <div id="problems">
        <h3>Problems: </h3>
        {%  if issue.problem_type.all %}
        <ul class="struct inline">
            {% for issue in issue.problem_type.all %}
                <li>{{ issue }}</li>
            {% endfor %}
        </ul>
        {% else %}
        No problem types defined
        {% endif %}
        <br class="clear" />
    </div>
</div>
{% for post in comments %}
<div id='post_{{ post.ip_id }}' class='comment'>
    <div class='post_date'>{{ post.post_date }} by {{ post.user }}</div>
    <p>
        {{ post.comment }}
    </p>
</div>
{% endfor %}

<form id='post_comment' method='post' action='/issue/{{ issue.issue_id}}/'>
<fieldset>
<!-- add_comment_form, update_issue_form -->
    <ul class="struct">
        <li><label for='assignee'>Assign To:</label> {{ update_issue_form.assignee }}</li>
        <li><label for='resolved_state'>Resolve:</label> {{ update_issue_form.resolved_state }}</li>
    </ul>
    <div>
        <label for='comment' style='display: block;'>{{ add_comment_form.comment.label }}</label>
        {{ add_comment_form.comment }}
    </div>
{% if comment_errors %}
{{ comment_errors }}
{% endif %}
<br class="clear" />
<input type="submit" name="submit" value="Submit" />
</fieldset>
</form>
</div>
<div id="issue_side">
    {% for item in history %}
    <div id='hist_{{ item.ih_id}}' class='history'>
        <h4>{{item.user}}<span class='date'>{{item.time}}</span></h4>
        <ul class='struct'>
            {{item.change}}
        </ul>
    </div>
    {% endfor %}
</div>
<br class='clear' />
{% endblock %}
